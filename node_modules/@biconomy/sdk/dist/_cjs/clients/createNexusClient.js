"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createNexusClient = createNexusClient;
const toNexusAccount_1 = require("../account/toNexusAccount.js");
const constants_1 = require("../constants/index.js");
const createBicoBundlerClient_1 = require("./createBicoBundlerClient.js");
const erc7579_1 = require("./decorators/erc7579/index.js");
const smartAccount_1 = require("./decorators/smartAccount/index.js");
async function createNexusClient(parameters) {
    const { client: client_, chain = parameters.chain ?? client_?.chain, signer, index = 0n, key = "nexus client", name = "Nexus Client", module, factoryAddress = constants_1.k1ValidatorFactoryAddress, k1ValidatorAddress = constants_1.k1ValidatorAddress, bundlerTransport, transport, accountAddress, ...bundlerConfig } = parameters;
    if (!chain)
        throw new Error("Missing chain");
    const nexusAccount = await (0, toNexusAccount_1.toNexusAccount)({
        accountAddress,
        transport,
        chain,
        signer,
        index,
        module,
        factoryAddress,
        k1ValidatorAddress
    });
    const bundler_ = (0, createBicoBundlerClient_1.createBicoBundlerClient)({
        ...bundlerConfig,
        chain,
        key,
        name,
        account: nexusAccount,
        transport: bundlerTransport
    })
        .extend((0, erc7579_1.erc7579Actions)())
        .extend((0, smartAccount_1.smartAccountActions)());
    return bundler_;
}
//# sourceMappingURL=createNexusClient.js.map